<!DOCTYPE html>
<html lang="en">

	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta charset="utf-8" />
		<title>置业绿城- 文章管理</title>

		<meta name="description" content="Common form elements and layouts" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

		<!-- bootstrap & fontawesome -->
		<link rel="stylesheet" href="assets/css/bootstrap.min.css" />
		<link rel="stylesheet" href="assets/font-awesome/4.5.0/css/font-awesome.min.css" />

		<!-- page specific plugin styles -->
		<link rel="stylesheet" href="assets/css/jquery-ui.custom.min.css" />
		<link rel="stylesheet" href="assets/css/chosen.min.css" />
		<link rel="stylesheet" href="assets/css/bootstrap-datepicker3.min.css" />
		<link rel="stylesheet" href="assets/css/bootstrap-timepicker.min.css" />
		<link rel="stylesheet" href="assets/css/daterangepicker.min.css" />
		<link rel="stylesheet" href="assets/css/bootstrap-datetimepicker.min.css" />
		<link rel="stylesheet" href="assets/css/bootstrap-colorpicker.min.css" />

		<!-- text fonts -->
		<link rel="stylesheet" href="assets/css/fonts.googleapis.com.css" />

		<!-- ace styles -->
		<link rel="stylesheet" href="assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />

		<!--[if lte IE 9]>
			<link rel="stylesheet" href="assets/css/ace-part2.min.css" class="ace-main-stylesheet" />
		<![endif]-->
		<link rel="stylesheet" href="assets/css/ace-skins.min.css" />
		<link rel="stylesheet" href="assets/css/ace-rtl.min.css" />
		<link rel="stylesheet" href="assets/css/myself.css" />
		<link rel="stylesheet" href="assets/css/artical.css">

		<!-- <link rel="stylesheet" href="assets/css/page.css" /> -->
		<!--[if lte IE 9]>
		  <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
		<![endif]-->

		<!-- inline styles related to this page -->

		<!-- ace settings handler -->
		<script src="assets/js/ace-extra.min.js"></script>

		<!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

		<!--[if lte IE 8]>
		<script src="assets/js/html5shiv.min.js"></script>
		<script src="assets/js/respond.min.js"></script>
		<![endif]-->
	</head>

	<body class="no-skin">
		<!--------------------------------------left toggle------------------------------------->
		<div id="navbar" class="navbar navbar-default ace-save-state">
			<div class="navbar-header pull-left">
				<a href="index.html" class="navbar-brand">
					<small>
						<i class="fa fa-leaf"></i>
							置业绿城
					</small>
				</a>
			</div>
			<div class="navbar-buttons navbar-header pull-right" role="navigation">
				<ul class="nav ace-nav">
					<li class="light-blue dropdown-modal">
						<a data-toggle="dropdown" href="#" class="dropdown-toggle">
							<span class="user-info">
								<small>Welcome,</small>
									Jason
							</span>
							<i class="ace-icon fa fa-caret-down"></i>
						</a>
					</li>
				</ul>
			</div>
		</div>
		<!-- /.navbar-container -->
		</div>
		<div class="main-container ace-save-state" id="main-container">
			<div id="sidebar" class="sidebar                  responsive                    ace-save-state">
				<script type="text/javascript">
					try {
						ace.settings.loadState('sidebar')
					} catch(e) {}
				</script>
				<ul class="nav nav-list">
					<li class=" ">
						<a href="#">
							<i class="menu-icon fa fa-tachometer"></i>
							<span class="menu-text"> 工作台 </span>
						</a>
					</li>
					<li class="">
						<a href="#" class="dropdown-toggle">
							<!--<i class="fa fa-briefcase fa-lg" ></i>-->
							<i class="menu-icon fa fa-caret-right"></i>
							<span class="menu-text">
								楼盘列表
							</span>
							<b class="arrow fa fa-angle-down"></b>
						</a>
						<b class="arrow"></b>
						<ul class="submenu">
							<li class="">
								<a href="profile.html">
									<i class="menu-icon fa fa-caret-right"></i> 楼盘列表
								</a>

								<b class="arrow"></b>
							</li>
							<li class="">
								<a href="timeline.html">
									<i class="menu-icon fa fa-caret-right"></i> 楼盘标签
								</a>

								<b class="arrow"></b>
							</li>
							<li class="">
								<a href="search.html">
									<i class="menu-icon fa fa-caret-right"></i> 板块排序
								</a>

								<b class="arrow"></b>
							</li>
						</ul>
					</li>
					<li class="">
						<a href="#" class="dropdown-toggle">
							<i class="menu-icon fa fa-list"></i>
							<span class="menu-text"> 文章管理 </span>
						</a>
						<b class="arrow"></b>
					</li>
					<li class="">
						<a href="#" class="dropdown-toggle">
							<i class="menu-icon fa fa-pencil-square-o"></i>
							<span class="menu-text"> 活动管理</span>
						</a>
						<b class="arrow"></b>
					</li>
					<li class="">
						<a href="#">
							<i class="menu-icon fa fa-list-alt"></i>
							<span class="menu-text"> 预约列表 </span>
						</a>
						<b class="arrow"></b>
					</li>
					<li class="">
						<a href="#">
							<i class="menu-icon fa fa-calendar"></i>
							<span class="menu-text">
								用户管理
							</span>
						</a>
						<b class="arrow"></b>
					</li>
					<li class="">
						<a href="#" class="dropdown-toggle">
							<i class="menu-icon fa fa-picture-o"></i>
							<span class="menu-text"> 首页管理</span>
							<b class="arrow fa fa-angle-down"></b>
						</a>
						<b class="arrow"></b>
						<ul class="submenu">
							<li class="">
								<a href="profile.html">
									<i class="menu-icon fa fa-caret-right"></i> User Profile
								</a>

								<b class="arrow"></b>
							</li>
							<li class="">
								<a href="timeline.html">
									<i class="menu-icon fa fa-caret-right"></i> Timeline
								</a>

								<b class="arrow"></b>
							</li>
							<li class="">
								<a href="search.html">
									<i class="menu-icon fa fa-caret-right"></i> Search Results
								</a>

								<b class="arrow"></b>
							</li>
						</ul>
					</li>
					<li class="">
						<a href="#" class="dropdown-toggle">
							<i class="menu-icon fa fa-tag"></i>
							<span class="menu-text"> 搜索管理</span>
						</a>
					</li>
					<li class="">
						<a href="#" class="dropdown-toggle">
							<i class="menu-icon fa fa-file-o"></i>
							<span class="menu-text">
								系统管理
							</span>
						</a>
					</li>
					<li class="">
						<a href="#">
							<i class="menu-icon fa fa-list-alt"></i>
							<span class="menu-text"> 绿粉汇</span>
						</a>
						<b class="arrow"></b>
					</li>
			</div>
			<!--======================================left toggle end=============================================-->
			<div class="main-content">
				<div class="main-content-inner">
					<div class="breadcrumbs ace-save-state" id="breadcrumbs">
					<ul class="breadcrumb sym">
						<li>
							<a href="article-management.html">文章管理</a>
						</li>
					</ul>
					<!-- /.breadcrumb -->
				</div>
					<div class="page-content">
						<div class="ace-settings-container" id="ace-settings-container">
							<div class="ace-settings-box clearfix" id="ace-settings-box">
								<div class="pull-left width-50">
								</div>
								<!-- /.pull-left -->
								<div class="pull-left width-50">
								</div>
								<!-- /.pull-left -->
							</div>
							<!-- /.ace-settings-box -->
						</div>
						<!-- /.ace-settings-container -->
						<div class="page-header" style="border: none;">
							<ul class="header-ul">
								<li class="spacing">
									城市：<input type="text" id="cityName" placeholder="输入城市名称" class="spacing-input" />
								</li>
								<li class="spacing">
									楼盘：
									<select class="select-choose" id="estateId">
										<option value="">全部</option>
									</select>
								</li>
								<li class="spacing">
									文章分类：
									<select class="select-choose" id="newsTypeId">
										<option value="">全部</option>
										
									</select>
								</li>
								<li class="spacing">
									文章搜索：<input type="text" id="title" placeholder="输入文章名称" class="spacing-input" />
								</li>
								<li class="spacing">
									<div class="sousuo" onclick="dataList()">
										搜索
									</div>
								</li>
							</ul>
							<div class="new-building">
								<a href="articles-edit.html">
									发布文章
								</a>
							</div>
						</div>
						<!-- /.page-header -->
						<div class="row">
							<div class="col-xs-12">
								<!-- PAGE CONTENT BEGINS -->
								<table id="simple-table" class="table  table-bordered table-hover">
									<thead>
										<tr>
											<th class="center">序号</th>
											<th class=" ">标题名称</th>
											<th>发布城市</th>
											<th>文章分类</th>
											<th class=" ">发布状态 </th>

											<th>
												<!--<i class="ace-icon fa fa-clock-o bigger-110 hidden-480"></i>-->
												发布时间
											</th>
											<th class=" ">阅读量</th>
											<th class="forwarding">转发量</th>
											<th>最后操作时间</th>
											<th>操作人</th>
											<th>操作</th>
										</tr>
									</thead>

									<tbody id="contexts">

									</tbody>
								</table>
								<div class="link" style="display: none;z-index: 1;" id="dialogs">
									<p>活动链接</p>
									<div class="link-input" style="border: none;">
										<input type="text" name="url" id="urls" style="width: 230px;height: 30px;">
									</div>
									<p class="copy">
										<button type="button" class="btn" data-dismiss="modal1" data-clipboard-demo data-clipboard-target="#shareUrl">复制</button>
									</p>
								</div>
								<!---->

							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- PAGE CONTENT ENDS -->
		</div>
		<!-- /.col -->
		</div>
		<!-- /.row -->
		</div>
		<!-- /.page-content -->
		</div>
		<!--====================================================================-->

		<!--===============================================================-->
		</div>
		<!-- /.main-content -->
		<a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
			<i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
		</a>
		</div>
		<!-- /.main-container -->

		<!-- basic scripts -->

		<!--[if !IE]> -->
		<script src="assets/js/jquery-2.1.4.min.js"></script>

		<!-- <![endif]-->

		<!--[if IE]>
<script src="assets/js/jquery-1.11.3.min.js"></script>
<![endif]-->
		<script type="text/javascript">
			if('ontouchstart' in document.documentElement) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
		</script>
		<script src="assets/js/bootstrap.min.js"></script>

		<!-- page specific plugin scripts -->

		<!--[if lte IE 8]>
		  <script src="assets/js/excanvas.min.js"></script>
		<![endif]-->
		<script src="assets/js/jquery-ui.custom.min.js"></script>
		<script src="assets/js/jquery.ui.touch-punch.min.js"></script>
		<script src="assets/js/chosen.jquery.min.js"></script>
		<script src="assets/js/spinbox.min.js"></script>
		<script src="assets/js/bootstrap-datepicker.min.js"></script>
		<script src="assets/js/bootstrap-timepicker.min.js"></script>
		<script src="assets/js/moment.min.js"></script>
		<script src="assets/js/daterangepicker.min.js"></script>
		<script src="assets/js/bootstrap-datetimepicker.min.js"></script>
		<script src="assets/js/bootstrap-colorpicker.min.js"></script>
		<script src="assets/js/jquery.knob.min.js"></script>
		<script src="assets/js/autosize.min.js"></script>
		<script src="assets/js/jquery.inputlimiter.min.js"></script>
		<script src="assets/js/jquery.maskedinput.min.js"></script>
		<script src="assets/js/bootstrap-tag.min.js"></script>

		<!-- ace scripts -->
		<script src="assets/js/ace-elements.min.js"></script>
		<script src="assets/js/ace.min.js"></script>
		<!-- inline scripts related to this page -->
		<script type="text/javascript">
			var token = "9061E0D14040C0A2473034D041C54376B5B6475218510768A4F_B_E_2_6_C_8_";
			// 获取url？后id
			function getParam(paramName) {
				paramValue = "", isFound = !1;
				if(this.location.search.indexOf("?") == 0 && this.location.search.indexOf("=") > 1) {
					arrSource = unescape(this.location.search).substring(1, this.location.search.length).split("&"), i = 0;
					while(i < arrSource.length && !isFound) arrSource[i].indexOf("=") > 0 && arrSource[i].split("=")[0].toLowerCase() == paramName.toLowerCase() && (paramValue = arrSource[i].split("=")[1], isFound = !0), i++
				}
				return paramValue == "" && (paramValue = null), paramValue
			}
			
			
			$(function() {
				dataList();
				estateds();
				newsTypeIds();
			})
			
			
			/**
			 * 数据列表
			 */
			function  dataList(){
				
				console.log($("#estateId").val());
				$.ajax({
						type: "post",
						headers: {
							'Accept': 'application/x-www-form-urlencoded;charset=utf-8' 
						},
						url: "http://10.100.26.247:8180/manager/3.0/content/news/list",
						dataType: 'json',
						data: {
							token: token,
							pageLimit: 10,
							cityName:$("#cityName").val(),
							estateId:$("#estateId").val(),
							newsTypeId:$("#newsTypeId").val(),
							title:$("#title").val()
						},
						success: function(result) {
							console.log(result.data.pageListData);
	
							/**
							 * 文章列表
							 */
							$("#contexts").html('');
							var str = "";
							$.each(result.data.pageListData, function(i, item) {
								/**
								 * 发布状态
								 */
								var isPublish;
								var look="查看";
								var edit="编辑";
								var doStatus="发布";
								var cancels="下架";
								var del="删除";
								var urls="链接";
								if("0"==item.isPublish){
									 isPublish="未发布";
									 cancels="";
									 look="";
								}
								else if("1"==item.isPublish){
									isPublish="已发布";
									doStatus="";
									del="";
									edit="";
								}
								else isPublish="未知";
	
								str += '<tr>';
								str += '<td>' + (i+1) + '</td>';
								str += '<td class="center"><div class="action-buttons"><a href="#" class="green bigger-140 show-details-btn" title="Show Details"><i class="ace-icon fa ">' + item.title + ' </i></a></div></td>';
								str += '<td><a href="#">' + item.cityName + '</a></td>';
								str += '<td>' + item.newsType + '</td>';
								str += '<td class="hidden-480">' + isPublish + '</td>';
								str += '<td>' + item.createTime + '</td>';
								str += '<td class="hidden-480">' + item.readCount + ' </td>';
								str += '<td>' + item.forwardCount + ' </td>';
								str += '<td>' + item.createTime + '</td>';
								str += '<td>' + item.creator + '</td>';
								str += '<td><a href="javascript:void(0)" onclick="doStatus(\'' + item.id+ '\',\'' +item.isPublish + '\')">'+doStatus+'</a>&nbsp;&nbsp;<a href="javascript:void(0)" onclick="doStatus(\'' + item.id+ '\',\'' +item.isPublish  + '\')">'+cancels+'</a>&nbsp;&nbsp;<a href="articles-edit.html?id=' + item.id + '">'+edit+'</a>&nbsp;&nbsp;<a href="articles-edit.html?id=' + item.id + '">'+look+'</a>&nbsp;&nbsp;<a href="#" onclick=doDelete(\'' + item.id + '\') style="" >'+del+'</a>&nbsp;&nbsp;<a a href="#" onclick="javascript:copyUrl(\'' + item.url + '\')">'+urls+'</a></td>';
								str += '</tr>';
							});
							str += "";
							$("#contexts").append(str);
	
						}
					});
			};
			
			/**
			 * 楼盘列表数据
			 */
			function estateds(){
				$.ajax({
						type: "post",
						headers: {
							'Accept': 'application/x-www-form-urlencoded;charset=utf-8' 
						},
						url: "http://10.100.26.247:8180/manager/3.0/building_info/list",
						dataType: 'json',
						data: {
							token: token
						},
						success: function(result) {
							var r=result.data.pageListData;
							//Jquery动态添加option
							for(var m = 0;m<r.length;m++){
								$("#estateId").append("<option value="+r[m].id+">"+r[m].estateName+"</option>");
							}
						}
					});
			};
			
			/**
			 * 文章类别数据
			 */
			function newsTypeIds(){
				$.ajax({
						type: "post",
						headers: {
							'Accept': 'application/x-www-form-urlencoded;charset=utf-8' 
						},
						url: "http://10.100.26.247:8180/manager/3.0/content/news/type/list",
						dataType: 'json',
						data: {
							token: token
						},
						success: function(result) {
							var r=result.data.pageListData;
							//Jquery动态添加option
							for(var m = 0;m<r.length;m++){
								$("#newsTypeId").append("<option value="+r[m].id+">"+r[m].newsName+"</option>");
							}
						}
					});
			};
			
			
			/**
			 * 文章发布
			 */
			function doStatus(i, s) {
				edit(i, "0" == s ? "1" : "0");
			};
		
			/**
			 *文章下架（取消发布）
			 */
			function doCancel(i, h) {
				edit(i, "1" == h ? "0" : "1");
			};
			
			/**
			 * 编辑
			 */
			function edit(ids,publish){
				$.ajax({
					type: "post",
					headers: {
						'Accept': 'application/x-www-form-urlencoded;charset=utf-8'
					},
					url: "http://10.100.26.247:8180/manager/3.0/content/news/modify",
					dataType: 'json',
					data: {
						token: token,
						id: ids,
						isPublish:publish
					},
					success: function (result) {
						console.log(result.data);
						if(1==result.data){
							alert("文章下架成功！！！");
							dataList();
						}
						else alert("文章下架失败！！！");
					}
				});
			}
			
			/**
				* 删除数据
				*/
			function doDelete(key) {
				$.ajax({
				type: "post",
				headers: {
					'Accept': 'application/x-www-form-urlencoded;charset=utf-8'
				},
				url: "http://10.100.26.247:8180/manager/3.0/content/news/discard",
				dataType: 'json',
				data: {
					token: token,
					id: key
				},
				success: function (result) {
					console.log(result.data);
					if(1==result.data){
						alert("数据删除成功！！！");
						dataList();
					} 
					else alert("数据删除失败！！！");
					}
				});
		
			};
			
			/**
			 * 文章链接
			 */
			function copyUrl(url) {  
				var Url=document.getElementById("input");  
				Url.select(); // 选择对象  
				document.execCommand("Copy"); // 执行浏览器复制命令  
				alert("复制成功！");  
			}
			
		</script>
	</body>

</html>